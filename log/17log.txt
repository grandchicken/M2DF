2023-10-13 14:09:26,074 INFO ============ Initialed with 1 GPU(s) =============
2023-10-13 14:09:26,074 INFO dataset: [['twitter17', './src/data/jsons/twitter17_info.json']]
2023-10-13 14:09:26,074 INFO checkpoint_dir: ./
2023-10-13 14:09:26,074 INFO lambda_init: 0.45
2023-10-13 14:09:26,074 INFO image_text_similarity_path: /home/data_ti6_d/lich/CurriculumLearningMABSA/PreprocessData/amended_similarity_by_whole2017.json
2023-10-13 14:09:26,074 INFO image_text_region_similarity_path: /home/data_ti6_d/lich/CurriculumLearningMABSA/PreprocessData/amended_similarity_by_region2017.json
2023-10-13 14:09:26,074 INFO object_nums_path: /home/data_ti6_d/lich/CurriculumLearningMABSA/PreprocessData/object_nums2017.json
2023-10-13 14:09:26,074 INFO bart_model: /home/data_ti6_d/lich/pretrain_model/bart-base
2023-10-13 14:09:26,074 INFO log_dir: 17_aesc
2023-10-13 14:09:26,074 INFO model_config: config/pretrain_base.json
2023-10-13 14:09:26,074 INFO device: cuda
2023-10-13 14:09:26,075 INFO text_only: False
2023-10-13 14:09:26,075 INFO checkpoint: /home/data_ti6_d/lich/MABSA_VLP/checkpoint/pytorch_model.bin
2023-10-13 14:09:26,075 INFO lr_decay_every: 4
2023-10-13 14:09:26,075 INFO lr_decay_ratio: 0.8
2023-10-13 14:09:26,075 INFO epochs: 55
2023-10-13 14:09:26,075 INFO eval_every: 1
2023-10-13 14:09:26,075 INFO lr: 4e-05
2023-10-13 14:09:26,075 INFO num_beams: 4
2023-10-13 14:09:26,075 INFO continue_training: False
2023-10-13 14:09:26,075 INFO warmup: 0.1
2023-10-13 14:09:26,075 INFO dropout: None
2023-10-13 14:09:26,075 INFO classif_dropout: None
2023-10-13 14:09:26,075 INFO attention_dropout: None
2023-10-13 14:09:26,075 INFO activation_dropout: None
2023-10-13 14:09:26,075 INFO grad_clip: 5.0
2023-10-13 14:09:26,075 INFO gpu_num: 1
2023-10-13 14:09:26,075 INFO cpu: False
2023-10-13 14:09:26,075 INFO amp: False
2023-10-13 14:09:26,075 INFO master_port: 12355
2023-10-13 14:09:26,075 INFO batch_size: 16
2023-10-13 14:09:26,075 INFO seed: 66
2023-10-13 14:09:26,076 INFO num_workers: 0
2023-10-13 14:09:26,076 INFO max_len: 10
2023-10-13 14:09:26,076 INFO max_len_a: 0.6
2023-10-13 14:09:26,076 INFO bart_init: 1
2023-10-13 14:09:26,076 INFO check_info:
2023-10-13 14:09:26,076 INFO is_check: 0
2023-10-13 14:09:26,076 INFO curriculum_pace: square
2023-10-13 14:09:26,076 INFO total_step: 35
2023-10-13 14:09:26,076 INFO task:
2023-10-13 14:09:26,076 INFO Loading model...
2023-10-13 14:10:21,843 INFO Loading data...
2023-10-13 14:14:02,713 INFO Region Similarity DEV  aesc_p:31.45 aesc_r:6.63 aesc_f:10.96
2023-10-13 14:15:51,642 INFO Similarity DEV  aesc_p:31.8 aesc_r:6.46 aesc_f:10.74
2023-10-13 14:15:51,643 INFO ==================== Epoch 1 =====================
2023-10-13 14:17:47,694 INFO DEV  aesc_p:36.36 aesc_r:6.8 aesc_f:11.46
2023-10-13 14:19:30,229 INFO ==================== Epoch 2 =====================
2023-10-13 14:21:14,502 INFO DEV  aesc_p:34.83 aesc_r:15.82 aesc_f:21.75
2023-10-13 14:22:55,990 INFO ==================== Epoch 3 =====================
2023-10-13 14:24:36,269 INFO DEV  aesc_p:45.57 aesc_r:36.73 aesc_f:40.68
2023-10-13 14:26:16,339 INFO ==================== Epoch 4 =====================
2023-10-13 14:27:56,256 INFO DEV  aesc_p:42.88 aesc_r:39.71 aesc_f:41.24
2023-10-13 14:29:40,792 INFO ==================== Epoch 5 =====================
2023-10-13 14:31:07,441 INFO DEV  aesc_p:48.78 aesc_r:47.53 aesc_f:48.15
2023-10-13 14:32:45,550 INFO ==================== Epoch 6 =====================
2023-10-13 14:34:14,740 INFO DEV  aesc_p:50.51 aesc_r:50.6 aesc_f:50.55
2023-10-13 14:35:49,579 INFO ==================== Epoch 7 =====================
2023-10-13 14:37:24,806 INFO DEV  aesc_p:51.47 aesc_r:51.96 aesc_f:51.71
2023-10-13 14:39:05,575 INFO ==================== Epoch 8 =====================
2023-10-13 14:40:44,452 INFO DEV  aesc_p:53.86 aesc_r:54.59 aesc_f:54.22
2023-10-13 14:42:25,333 INFO ==================== Epoch 9 =====================
2023-10-13 14:44:06,768 INFO DEV  aesc_p:54.33 aesc_r:57.06 aesc_f:55.66
2023-10-13 14:45:52,589 INFO ==================== Epoch 10 ====================
2023-10-13 14:47:23,377 INFO DEV  aesc_p:56.95 aesc_r:58.5 aesc_f:57.72
2023-10-13 14:49:02,200 INFO ==================== Epoch 11 ====================
2023-10-13 14:50:41,606 INFO DEV  aesc_p:54.83 aesc_r:60.29 aesc_f:57.43
2023-10-13 14:52:23,899 INFO ==================== Epoch 12 ====================
2023-10-13 14:54:05,429 INFO DEV  aesc_p:56.66 aesc_r:58.93 aesc_f:57.77
2023-10-13 14:55:50,270 INFO ==================== Epoch 13 ====================
2023-10-13 14:57:34,195 INFO DEV  aesc_p:58.52 aesc_r:61.05 aesc_f:59.76
2023-10-13 14:59:17,712 INFO ==================== Epoch 14 ====================
2023-10-13 15:01:02,083 INFO DEV  aesc_p:57.95 aesc_r:61.65 aesc_f:59.74
2023-10-13 15:02:47,962 INFO ==================== Epoch 15 ====================
2023-10-13 15:04:33,336 INFO DEV  aesc_p:60.25 aesc_r:61.99 aesc_f:61.11
2023-10-13 15:06:16,934 INFO ==================== Epoch 16 ====================
2023-10-13 15:08:02,304 INFO DEV  aesc_p:58.57 aesc_r:60.46 aesc_f:59.5
2023-10-13 15:09:50,877 INFO ==================== Epoch 17 ====================
2023-10-13 15:11:42,007 INFO DEV  aesc_p:59.71 aesc_r:62.5 aesc_f:61.07
2023-10-13 15:13:33,350 INFO ==================== Epoch 18 ====================
2023-10-13 15:15:25,222 INFO DEV  aesc_p:59.95 aesc_r:61.73 aesc_f:60.83
2023-10-13 15:17:22,372 INFO ==================== Epoch 19 ====================
2023-10-13 15:19:15,658 INFO DEV  aesc_p:58.3 aesc_r:61.82 aesc_f:60.01
2023-10-13 15:21:13,127 INFO ==================== Epoch 20 ====================
2023-10-13 15:23:15,340 INFO DEV  aesc_p:61.21 aesc_r:62.67 aesc_f:61.93
2023-10-13 15:25:10,352 INFO ==================== Epoch 21 ====================
2023-10-13 15:27:11,491 INFO DEV  aesc_p:59.64 aesc_r:62.33 aesc_f:60.96
2023-10-13 15:29:17,083 INFO ==================== Epoch 22 ====================
2023-10-13 15:31:18,390 INFO DEV  aesc_p:59.75 aesc_r:61.73 aesc_f:60.73
2023-10-13 15:33:23,394 INFO ==================== Epoch 23 ====================
2023-10-13 15:35:30,934 INFO DEV  aesc_p:60.55 aesc_r:63.69 aesc_f:62.08
2023-10-13 15:37:39,295 INFO ==================== Epoch 24 ====================
2023-10-13 15:39:45,046 INFO DEV  aesc_p:59.86 aesc_r:63.52 aesc_f:61.63
2023-10-13 15:41:57,584 INFO ==================== Epoch 25 ====================
2023-10-13 15:44:13,277 INFO DEV  aesc_p:58.77 aesc_r:63.27 aesc_f:60.93
2023-10-13 15:46:27,045 INFO ==================== Epoch 26 ====================
2023-10-13 15:48:41,455 INFO DEV  aesc_p:62.48 aesc_r:63.86 aesc_f:63.16
2023-10-13 15:51:01,301 INFO ==================== Epoch 27 ====================
2023-10-13 15:53:16,991 INFO DEV  aesc_p:61.27 aesc_r:64.03 aesc_f:62.62
2023-10-13 15:55:37,776 INFO ==================== Epoch 28 ====================
2023-10-13 15:57:57,042 INFO DEV  aesc_p:60.06 aesc_r:63.95 aesc_f:61.94
2023-10-13 16:00:25,422 INFO ==================== Epoch 29 ====================
2023-10-13 16:02:51,796 INFO DEV  aesc_p:61.83 aesc_r:63.35 aesc_f:62.58
2023-10-13 16:05:14,830 INFO ==================== Epoch 30 ====================
2023-10-13 16:07:38,275 INFO DEV  aesc_p:59.71 aesc_r:62.76 aesc_f:61.19
2023-10-13 16:10:13,104 INFO ==================== Epoch 31 ====================
2023-10-13 16:12:39,655 INFO DEV  aesc_p:60.67 aesc_r:63.35 aesc_f:61.98
2023-10-13 16:15:10,119 INFO ==================== Epoch 32 ====================
2023-10-13 16:17:42,566 INFO DEV  aesc_p:60.02 aesc_r:61.9 aesc_f:60.95
2023-10-13 16:20:19,624 INFO ==================== Epoch 33 ====================
2023-10-13 16:22:51,750 INFO DEV  aesc_p:61.45 aesc_r:64.12 aesc_f:62.75
2023-10-13 16:25:34,179 INFO ==================== Epoch 34 ====================
2023-10-13 16:28:11,996 INFO DEV  aesc_p:59.95 aesc_r:61.99 aesc_f:60.95
2023-10-13 16:30:55,590 INFO ==================== Epoch 35 ====================
2023-10-13 16:33:39,788 INFO DEV  aesc_p:60.96 aesc_r:62.93 aesc_f:61.92
2023-10-13 16:36:24,726 INFO ==================== Epoch 36 ====================
2023-10-13 16:39:11,776 INFO DEV  aesc_p:61.55 aesc_r:63.44 aesc_f:62.48
2023-10-13 16:42:05,204 INFO ==================== Epoch 37 ====================
2023-10-13 16:44:57,797 INFO DEV  aesc_p:60.99 aesc_r:63.95 aesc_f:62.43
2023-10-13 16:47:49,576 INFO ==================== Epoch 38 ====================
2023-10-13 16:50:35,649 INFO DEV  aesc_p:61.93 aesc_r:63.78 aesc_f:62.84
2023-10-13 16:53:29,200 INFO ==================== Epoch 39 ====================
2023-10-13 16:56:23,011 INFO DEV  aesc_p:60.85 aesc_r:63.18 aesc_f:61.99
2023-10-13 16:59:24,450 INFO ==================== Epoch 40 ====================
2023-10-13 17:02:22,369 INFO DEV  aesc_p:61.26 aesc_r:63.86 aesc_f:62.53
2023-10-13 17:05:22,801 INFO ==================== Epoch 41 ====================
2023-10-13 17:08:16,647 INFO DEV  aesc_p:61.03 aesc_r:64.2 aesc_f:62.58
2023-10-13 17:11:21,947 INFO ==================== Epoch 42 ====================
2023-10-13 17:14:23,852 INFO DEV  aesc_p:63.58 aesc_r:65.48 aesc_f:64.52
2023-10-13 17:17:28,807 INFO ==================== Epoch 43 ====================
2023-10-13 17:20:37,596 INFO DEV  aesc_p:61.17 aesc_r:64.29 aesc_f:62.69
2023-10-13 17:23:45,283 INFO ==================== Epoch 44 ====================
2023-10-13 17:26:49,608 INFO DEV  aesc_p:62.43 aesc_r:64.71 aesc_f:63.55
2023-10-13 17:29:59,758 INFO ==================== Epoch 45 ====================
2023-10-13 17:33:08,329 INFO DEV  aesc_p:62.85 aesc_r:64.88 aesc_f:63.85
2023-10-13 17:36:16,909 INFO ==================== Epoch 46 ====================
2023-10-13 17:39:26,172 INFO DEV  aesc_p:62.14 aesc_r:63.35 aesc_f:62.74
2023-10-13 17:42:32,377 INFO ==================== Epoch 47 ====================
2023-10-13 17:45:42,025 INFO DEV  aesc_p:62.05 aesc_r:64.8 aesc_f:63.39
2023-10-13 17:48:51,855 INFO ==================== Epoch 48 ====================
2023-10-13 17:52:00,634 INFO DEV  aesc_p:62.4 aesc_r:64.63 aesc_f:63.49
2023-10-13 17:55:10,440 INFO ==================== Epoch 49 ====================
2023-10-13 17:58:19,850 INFO DEV  aesc_p:62.43 aesc_r:64.29 aesc_f:63.34
2023-10-13 18:01:28,140 INFO ==================== Epoch 50 ====================
2023-10-13 18:04:35,353 INFO DEV  aesc_p:62.59 aesc_r:64.88 aesc_f:63.72
2023-10-13 18:07:39,030 INFO ==================== Epoch 51 ====================
2023-10-13 18:10:51,852 INFO DEV  aesc_p:62.98 aesc_r:64.97 aesc_f:63.96
2023-10-13 18:13:58,971 INFO ==================== Epoch 52 ====================
2023-10-13 18:17:09,621 INFO DEV  aesc_p:62.7 aesc_r:64.88 aesc_f:63.77
2023-10-13 18:20:16,831 INFO ==================== Epoch 53 ====================
2023-10-13 18:23:23,738 INFO DEV  aesc_p:63.34 aesc_r:65.39 aesc_f:64.35
2023-10-13 18:26:30,746 INFO ==================== Epoch 54 ====================
2023-10-13 18:29:42,519 INFO DEV  aesc_p:62.95 aesc_r:64.88 aesc_f:63.9
2023-10-13 18:32:55,278 INFO ==================== Epoch 55 ====================
2023-10-13 18:36:06,137 INFO DEV  aesc_p:63.19 aesc_r:64.97 aesc_f:64.07
2023-10-13 18:41:32,904 INFO ====== Training complete in: 4:30:01.621299 ======
2023-10-13 18:41:32,905 INFO ---------------------------
2023-10-13 18:41:32,905 INFO BEST DEV TEST:-----
2023-10-13 18:41:32,905 INFO BEST DEV--TEST  aesc_p:68.0 aesc_r:68.72 aesc_f:68.36